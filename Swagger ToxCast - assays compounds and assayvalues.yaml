# this is an example of a REST APi that exposes
# exactly one Assay endpoint from toxcast suitable
# for binary classification
swagger: '2.0'
info:
  title: ToxcastDB interface (Assay information, Compound information and assay values for tested compounts)
  description: |
    This Api exposes the EPA's ToxCast summary dataset (October 2015 release).

    ToxCast contains data for a single chemical endpoint pair for thousands of chemicals and 821 assay endpoints for 20 variables such
    as the activity or hit call, activity concentrations, whether the chemical was tested in a specific assay, etc.
  version: "1.0.0"
# the domain of the service - in our use-case somewhat nonsensical but mandatory
host: toxcastdb
# array of all schemes that your API supports
schemes:
  - http
# will be prefixed to all paths
basePath: /v1
produces:
  - application/json
paths:
  /assays:
    get:
      summary: "Returns all assay endpoints known to toxcast including metadata about each assay"
      description: "For each assay (endpoint), returns metadata like assay description, assay source, organism, tissue, cell format, ..."
      tags:
        - assays, assay endpoints
      parameters:
        - name: assayIds
          description: "Assay ids to filter on a subset of assay endpoints"
          in: query
          type: array
          collectionFormat: csv
          required: false
          items:
            type: string
        - $ref: '#/parameters/OffsetParameter'
        - $ref: '#/parameters/LimitParameter'
        - name: facetOrganism
          description: "Faceting terms for the organism field"
          in: query
          type: array
          collectionFormat: csv
          required: false
          items:
            type: string
        - name: facetAssayName
          description: "Faceting terms for the assay name field"
          in: query
          type: array
          collectionFormat: csv
          required: false
          items:
            type: string
        - name: facetTissue
          description: "Faceting terms for the tissue field"
          in: query
          type: array
          collectionFormat: csv
          required: false
          items:
            type: string
        - name: facetCellFormat
          description: "Faceting terms for the cell format field"
          in: query
          type: array
          collectionFormat: csv
          required: false
          items:
            type: string
        - name: facetAssayDesignType
          description: "Faceting terms for the assay design type field"
          in: query
          type: array
          collectionFormat: csv
          required: false
          items:
            type: string
        - name: facetFunction
          description: "Faceting terms for the assay function field"
          in: query
          type: array
          collectionFormat: csv
          required: false
          items:
            type: string
        - name: facetIntendedTarget
          description: "Faceting terms for the intended Target field"
          in: query
          type: array
          collectionFormat: csv
          required: false
          items:
            type: string
      responses:
        200:
          description: "An array of assay endpoints including metadata about the assay endpoints"
          schema:
            $ref: '#/definitions/AssayEndpoints'
        default:
          description: "Unexpected error"
          schema:
            $ref: '#/definitions/Error'
  /assays/{assayId}:
    get:
      summary: "Returns all assay endpoints known to toxcast including metadata about each assay"
      description: "For each assay, returns metadata like assay description, assay source, organism, tissue, cell format, ..."
      tags:
        - assays, assay endpoints
      parameters:
        - name: assayId
          description: "Assay endpoint id to get metadata for"
          in: path
          type: string
          required: true
      responses:
        200:
          description: "An array of assay endpoints including metadata about the assay endpoints"
          schema:
            $ref: '#/definitions/AssayEndpoint'
        default:
          description: "Unexpected error"
          schema:
            $ref: '#/definitions/Error'
  /compounds:
    get:
      summary: "Get data on compounds and a list of assay endpoint names that tested this compound"
      description: "Returns, for a given compound, a list of assay endpoint names that tested this compound"
      tags:
        - compound
      parameters:
        - name: compoundIds
          description: "Optional list of toxcast compound Ids to get data for"
          in: query
          type: array
          collectionFormat: csv
          required: false
          items:
            type: string
        - $ref: '#/parameters/OffsetParameter'
        - $ref: '#/parameters/LimitParameter'
      responses:
        200:
          description: "An array of items containing identifiers for the compound and the assay values (hitcall etc)"
          schema:
            type: array
            items:
              $ref: '#/definitions/CompoundWithAssays'
        default:
          description: "Unexpected error"
          schema:
            $ref: '#/definitions/Error'
  /compounds/{compoundId}:
    get:
      summary: "Get data on one specific compound and a list of assay endpoint names that tested this compound"
      description: "Returns, for a given compound, a list of assay endpoint names that tested this compound"
      tags:
        - compound
      parameters:
        - name: compoundId
          description: "Toxcast Compound Id to query"
          in: path
          type: string
          required: true
      responses:
        200:
          description: "An array of items containing identifiers for the compound and the assay values (hitcall etc)"
          schema:
            $ref: '#/definitions/CompoundWithAssays'
        default:
          description: "Unexpected error"
          schema:
            $ref: '#/definitions/Error'
  /results:
    get:
      summary: "Assay endpoint result values for all successfully tested compounds"
      description: "Returns a list of rows containing the assayId, compound identifiers and the measured/derived assay endpoint values"
      tags:
        - assay
      parameters:
        - name: assayIds
          description: "Assay endpoint ids to query"
          in: query
          type: array
          collectionFormat: csv
          required: true
          items:
            type: string
        - name: compounds
          description: "list of compounds to include in the result. Uses toxcast internal identifier for compounds (toxcastCompoundId)"
          in: query
          required: false
          type: array
          collectionFormat: csv
          items:
            type: string
        - $ref: '#/parameters/OffsetParameter'
        - $ref: '#/parameters/LimitParameter'
      responses:
        200:
          description: "An array of items containing the assay values (hitcall etc), compound ids and assay ids"
          schema:
            $ref: '#/definitions/AssayResults'
        default:
          description: "Unexpected error"
          schema:
            $ref: '#/definitions/Error'
parameters:
  OffsetParameter:
    name: offset
    description: "Number of assay endpoints to skip (for paging)"
    in: query
    required: false
    type: integer
  LimitParameter:
    name: limit
    description: "Maximum count of assay endpoints to return (for paging)"
    in: query
    required: false
    type: integer
definitions:
  CompoundWithAssays:
    type: object
    properties:
      compound:
        $ref: '#/definitions/Compound'
      assaysTested:
        type: array
        items:
          type: object
          description: "A list of assayIds that tested this compound."
          properties:
            assayId:
              description: "Assay endoint id"
              type: string
            assayEndpointName:
              description: "Assay endpoint name"
              type: string
            assayEndpointDesc:
              description: "Verbose assay endpoint description"
              type: string
  Compound:
    type: object
    properties:
      compoundId:
        type: integer
        description: "Internal identifier of compounds within Toxcast"
      chemicalName:
        type: string
        description: "Chemical name (as stored in ToxCast)          "
      casNumber:
        type: string
        description: "CAS Number as stored in Toxcast. Can be empty string if no valid CAS number is stored in ToxCast."
        x-ontology: http://edamontology.org/data_3102
      inchi:
        type: string
        description: |
          Compound structure converted to InChI notation. This string can be empty if a conversion from the
          internal id to an inchi string was not successful.
        x-ontology: http://edamontology.org/format_1197
      inchiKey:
        type: string
        description: |
          Compound structure converted to InChIKey. This string can be empty if a conversion from the
          internal id to an inchiKey string was not successful.
        x-ontology: http://edamontology.org/format_1199
      smiles:
        type: string
        description: |
          Compound structure converted to SMILES notation. This string can be empty if a conversion from the
          internal id to a SMILES string was not successful.
        x-ontology: http://edamontology.org/format_1196
  AssayResults:
    type: array
    items:
      type: object
      properties:
        assay:
          $ref: '#/definitions/AssayEndpoint'
        compound:
          $ref: '#/definitions/Compound'
        result:
          $ref: '#/definitions/AssayResultValues'
  AssayResultValues:
    type: object
    properties:
      fitCategory:
        type: integer
        description: "Fit Category (numeric category id - See https://cran.rstudio.com/web/packages/tcpl/vignettes/tcpl_Overview.pdf)"
      hitcall:
        type: integer
        description: "ToxcastDB Assay HitCall value. Inactive = 0, Active = 1, Inconclusive = -1"
      level4Id:
        type: integer
        description: "level 4 id inside the full toxcast database"
      log10ConcentrationMax:
        type: number
        description: "log base 10 of the maximum concentration tested"
      log10ConcentrationMin:
        type: number
        description: "log base 10 of the minimum concentration tested"
      maxMean:
        type: number
        description: "the maximum of the means at each concentration"
      maxMedian:
        type: number
        description: "the maximum of the medians at each concentration"
      ac10:
        type: number
        description: "AC10 (activity concentration at 10%) for the winning model"
      acBaseline:
        type: number
        description: "Activity concentration at baseline for the winning model"
      acCutoff:
        type: number
        description: "Activity concentration at cutoff for the winning model"
      gainAc50:
        type: number
        description: "Gain AC50 (activity concentration at 50%) for the winning model"
      gainHillCoefficient:
        type: number
        description: "Gain Hill coefficient for the winning model"
      lossAc50:
        type: number
        description: "Loss AC50 (activity concentration at 50%) for the winning model"
      lossHillCoefficient:
        type: number
        description: "Loss Hill coefficient for the winning model"
      winningModel:
        type: string
        description: "Winning model. (Used values: cnst, hill, gnls)"
      rmse:
        type: number
        description: "Root mean square error of the winnign model"
      oldstyleAc50:
        type: number
        description: "gainAc50 in micromolar (not log10) units."
      oldstyleNegLogAc50:
        type: number
        description: "The negative log10 transformation of the oldstyleAc5ß value anchored to zero"
      sampleId:
        type: string
        description: "The id of the selected sample"
      zScore:
        type: number
        description: "the zscore of AC50 values based on the chemical-specific cytotoxicity distribution file"
  AssayEndpoints:
    type: object
    properties:
      facets:
        type: object
        properties:
          assayName:
            $ref: '#/definitions/FacetGroup'
          organism:
            $ref: '#/definitions/FacetGroup'
          tissue:
            $ref: '#/definitions/FacetGroup'
          cellFormat:
            $ref: '#/definitions/FacetGroup'
          assayDesignType:
            $ref: '#/definitions/FacetGroup'
          assayFunction:
            $ref: '#/definitions/FacetGroup'
          intendedTarget:
            $ref: '#/definitions/FacetGroup'
      assayEndpoints:
        type: array
        items:
          $ref: '#/definitions/AssayEndpoint'
  AssayEndpoint:
    type: object
    properties:
      assayId:
        type: integer
        description: "Assay endpoint id"
      assaySourceName:
        type: string
        description: "a short name for the entity that conducted the assay"
      assaySourceLongName:
        type: string
        description: "the long name for the entity that conducted the assay"
      assaySourceDesc:
        type: string
        description: "Description of the organization that performed the assay"
      assayName:
        type: string
        description: "a short name for the assay, e.g. BSK_3C"
      assayDesc:
        type: string
        description: "Description of the assay"
      timepointHr:
        type: number
        description: "the duration length to conduct the test portion of the assay"
      organismId:
        type: integer
        description: "The NCBI Taxonomy id of the organism"
        x-ontology: http://purl.obolibrary.org/obo/OGG_0000000015
      organism:
        type: string
        description: "The target organism"
      tissue:
        type: string
        description: "the organ-level, anatomical entity of the protein or cell used in the assay"
      cellFormat:
        type: string
        description: "The target cell format"
      cellFreeComponentSource:
        type: string
        description: "the cellular or sample tissue source of the assayed gene protein"
      cellShortName:
        type: string
        description: "Cell short name"
      cellGrowthMode:
        type: string
        description: "Cell growth mode"
      assayFootprint:
        type: string
        description: "the physical format, such as plate density, in which an assay is performed"
      assayFormatType:
        type: string
        description: "the conceptual biological and/or chemical features of the assay system"
      assayFormatTypeSub:
        type: string
        description: "assay format subtype"
      contentReadoutType:
        type: string
        description: "the throughput and information content generated"
      dilutionSolvent:
        type: string
        description: "the solvent used as the negative control and to solubilize the test chemical"
      dilutionSolventPercentMax:
        type: number
        description: "the maximal amount of the dilution solvent tolerable for a particular assay"
      assayComponentName:
        type: string
        description: "a short name containing the assay and a component readout, e.g. BSK_3C_IL8"
      assayComponentDesc:
        type: string
        description: "assay component description"
      assayComponentTargetDesc:
        type: string
        description: "assay component target description"
      parameterReadoutType:
        type: string
        description: "parameter readout type"
      assayDesignType:
        type: string
        description: "assay design type"
      assayDesignTypeSub:
        type: string
        description: "assay design subtype"
      biologicalProcessTarget:
        type: string
        description: "biological process target"
      detectionTechnologyType:
        type: string
        description: "detection technology type"
      detectionTechnologyTypeSub:
        type: string
        description: "detection technology subtype"
      detectionTechnology:
        type: string
        description: "detection technology"
      signalDirectionType:
        type: string
        description: "signal direction type"
      keyAssayReagentType:
        type: string
        description: "key assay reagent type"
      keyAssayReagent:
        type: string
        description: "key assay reagent"
      technologicalTargetType:
        type: string
        description: "the measured chemical, molecular, cellular, or anatomical entity"
      technologicalTargetTypeSub:
        type: string
        description: "the measured chemical, molecular, cellular, or anatomical subtype"
      assayEndpointName:
        type: string
        description: "A short name containing the assay, the component readout, and an analysis applied, e.g. BSK_3C_IL8_up"
      assayEndpointDesc:
        type: string
        description: "Description of the assay endpoint"
      assayFunctionType:
        type: string
        description: "assay function type"
      normalizedDataType:
        type: string
        description: "normalized data type"
      analysisDirection:
        type: string
        description: "analysis direction (used values: positive/negative)"
      burstAssay:
        type: boolean
        description: "burst assay"
      keyPositiveControl:
        type: string
        description: "key positive control"
      signalDirection:
        type: string
        description: "signal direction (used values: loss/gain)"
      intendedTargetType:
        type: string
        description: "the objective chemical, molecular, cellular, pathway or anatomical entity"
      intendedTargetTypeSub:
        type: string
        description: "the objective chemical, molecular, cellular, pathway or anatomical entity"
      intendedTargetFamily:
        type: string
        description: "the target family of the objective target for the assay"
      intendedTargetFamilySub:
        type: string
        description: "the target family of the objective target for the assay"
      intendedTargetGeneId:
        type: array
        items:
          type: integer
        description: "List of target gene ids that are the objective "
      intendedTargetEntrezGeneId:
        type: array
        items:
          type: integer
        description: "List of target gene ids that are the objective (NCBI Entrez gene id)"
      intendedTargetOfficialFullName:
        type: array
        items:
          type: string
        description: "List of objective target offical full names"
      intendedTargetGeneName:
        type: array
        items:
          type: string
        description: "List of objective target gene names"
      intendedTargetOfficialSymbol:
        type: array
        items:
          type: string
        description: "List of objective target offical symbols"
      intendedTargetGeneSymbol:
        type: array
        items:
          type: string
        description: "List of objective target symbols"
      intendedTargetDescription:
        type: string
        description: "objective target description"
      intendedTargetUniprotAccessionNumber:
        type: string
        description: "objective target uniprot accesscion number"
      intendedTargetOrganismId:
        type: integer
        description: "intended target organism id"
      intendedTargetTrackStatus:
        type: string
        description: "objective target track status (used values: live)"
      technologicalTargetGeneId:
        type: array
        items:
          type: integer
        description: "measured molecular target gene id"
      technologicalTargetEntrezGeneId:
        type: array
        items:
          type: integer
        description: "List of measured molecular target gene ids (NCBI Entrez gene id)"
      technologicalTargetOfficialFullName:
        type: array
        items:
          type: string
        description: "List of measured molecular target offical full names"
      technologicalTargetGeneName:
        type: array
        items:
          type: string
        description: "List of technolmeasured molecularogical target gene names"
      technologicalTargetOfficialSymbol:
        type: array
        items:
          type: string
        description: "List of measured molecular target offical symbols"
      technologicalTargetGeneSymbol:
        type: array
        items:
          type: string
        description: "List of measured molecular target symbols"
      technologicalTargetDescription:
        type: string
        description: "measured molecular target description"
      technologicalTargetUniprotAccessionNumber:
        type: string
        description: "measured molecular target uniprot accesscion number"
      technologicalTargetOrganismId:
        type: integer
        description: "measured molecular target organism id"
      technologicalTargetTrackStatus:
        type: string
        description: "measured molecular target track status (used values: live)"
      citationsCitationId:
        type: array
        items:
          type: string
        description: "List of citation ids"
      citationsPmid:
        type: array
        items:
          type: string
        description: "List of PubMed citation ids"
      citationsDoi:
        type: array
        items:
          type: string
        description: "List of citation digital object identifiers"
      citationsCitation:
        type: array
        items:
          type: string
        description: "List of citation texts"
      citationsTitle:
        type: array
        items:
          type: string
        description: "List of citation titles"
      citationsAuthor:
        type: array
        items:
          type: string
        description: "List of citation authors"
      citationsUrl:
        type: array
        items:
          type: string
          format: url
        description: "List of citation urls"
  FacetGroup:
    type: object
    properties:
      title:
        type: string
        description: "Display title for the group of faceting terms"
      terms:
        type: array
        description: "Faceting terms for this group"
        items:
          type: object
          properties:
            term:
              type: string
              description: "term to display to the user"
            count:
              type: integer
              description: "number of items if the current view is filtered by exactly this additional term"
            url:
              type: string
              format: url
              description: "Preconfigured endpoint url with the same result set as the current one but also filtered to this term"
  Error:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      fields:
        type: string
